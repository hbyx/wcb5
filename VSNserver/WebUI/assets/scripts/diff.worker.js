/* Copyright (c) 2020 VisualSVN Software Ltd. All rights reserved. */
var DiffImpl;!function(e){function r(e){var n=e.split(/\r\n|\n|\r/);return""===n[n.length-1]&&n.pop(),n}function l(e,n){for(var r=function(e,n){for(var r=e.length,l=n.length,d=r-l,i=r+l+3,o=l+1,v=[],a=0;a<i;a++)v.push({x:0,y:-1,lcs:null});var f=0;do{for(var t=(d<0?d:0)-f;t<0;t++)s(v,e,n,t+o);for(var t=(0<d?d:0)+f;0<=t;t--)s(v,e,n,t+o);f++}while(v[o].y!=l);var u=v[o].lcs;return u=function(e){for(var n,r=null;e;)n=e.link,e.link=r,r=e,e=n;return r}(u=c(u,r,l,0))}(e,n),l=0,d=0,i=[];l<r.x&&i.push({added:void 0,removed:!0,value:e.slice(l,r.x)}),d<r.y&&i.push({added:!0,removed:void 0,value:n.slice(d,r.y)}),r.len;)i.push({added:void 0,removed:void 0,value:e.slice(r.x,r.x+r.len)}),l=r.x+r.len,d=r.y+r.len,r=r.link;return i}function c(e,n,r,l){return{x:n,y:r,len:l,link:e}}function s(e,n,r,l){var d,i,o,v=n.length,a=r.length,f=e[l-1],t=e[l+1];f.y>=t.y?(d=f.x,i=f.y+1,o=f.lcs):(d=t.x+1,i=t.y,o=t.lcs);for(var u=d,s=i;u<v&&s<a&&n[u]===r[s];)u++,s++;d<u&&(o=c(o,d,i,u-d)),e[l].x=u,e[l].y=s,e[l].lcs=o}e.diffLines=function(e,n){return n===e?[{value:r(n),removed:void 0,added:void 0}]:n?e?l(r(e),r(n)):[{value:r(n),removed:void 0,added:!0}]:[{value:r(e),removed:!0,added:void 0}]},e.tokenize=r,e.diff=l}(DiffImpl||(DiffImpl={})),addEventListener("message",function(e){var n=e.data;try{var r=DiffImpl.diffLines(n.oldStr,n.newStr);this.postMessage(r)}finally{close()}});