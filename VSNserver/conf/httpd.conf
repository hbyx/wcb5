#
# This is configuration file for Apache HTTP server which is
# part of VisualSVN Server.
#
# DO NOT EDIT THIS FILE IT WILL BE REGENERATED AUTOMATICALLY BY VISUALSVN SERVER
#
# Contact with VisualSVN Software Ltd. (support@visualsvn.com) if you
# have suggestions and improvements.
#

MinThreadsPerChild 0
MaxThreadsPerChild 1024
MaxMemFree 64
MaxConnectionsPerChild  0
MaxKeepAliveRequests 0
Timeout 300
KeepAliveTimeout 5
AcceptFilter http none
AcceptFilter https none
LimitXMLRequestBody 8000000
LimitRequestFieldSize 16384
SendBufferSize 0

ServerRoot "E:/学期项目二/VSNserver"
ServerName "DESKTOP-9M6F2ED:8443"
ServerSignature Off
ServerTokens Prod
DocumentRoot "htdocs"
FileETag MTime Size

ExpiresActive on
ExpiresDefault access

PidFile "${TEMP}\VisualSVNServer.pid"

Listen "8443" https

LoadModule licensing_visualsvn_module bin/mod_licensing_visualsvn.so
LoadModule auth_basic_module bin/mod_auth_basic.so
LoadModule authn_core_module bin/mod_authn_core.so
LoadModule authz_core_module bin/mod_authz_core.so
LoadModule authn_file_module bin/mod_authn_file.so
LoadModule authz_user_module bin/mod_authz_user.so
LoadModule authz_visualsvn_module bin/mod_authz_visualsvn.so
LoadModule alias_module bin/mod_alias.so
LoadModule dir_module bin/mod_dir.so
LoadModule mime_module bin/mod_mime.so
LoadModule setenvif_module bin/mod_setenvif.so
LoadModule rewrite_module bin/mod_rewrite.so
LoadModule expires_module bin/mod_expires.so
LoadModule dav_module bin/mod_dav.so
LoadModule visualsvn_module bin/mod_visualsvn.so
LoadModule headers_module bin/mod_headers.so
LoadModule ssl_module bin/mod_ssl.so
LoadModule deflate_module bin/mod_deflate.so
LoadModule deflate_fh_module bin/mod_deflate_fh.so

Header always append X-Frame-Options SAMEORIGIN
SVNCompressionLevel 1
DeflateCompressionLevel 1
DeflateAlterETag NoChange
SetOutputFilter DEFLATE_FH;DEFLATE

<Directory />
  Options FollowSymLinks
  AllowOverride None

  RewriteEngine on
  RewriteCond %{REQUEST_URI} ^/svn$
  RewriteCond %{HTTP_USER_AGENT} !^SVN/
  RewriteRule ^(.*/svn)$ %0/ [R=301,L]
</Directory>

RewriteEngine on
RewriteCond %{REQUEST_METHOD}  =GET  [OR]
RewriteCond %{REQUEST_METHOD}  =HEAD
RewriteRule "^/favicon.ico$" "/!/assets/img/favicon.ico" [PT,NS]

<Location />
  AuthName "VisualSVN Server"
  AuthType Basic
  AuthBasicProvider file
  AuthUserFile "E:/学期项目二/Repositorries/htpasswd"

  Require valid-user
</Location>

SVNInMemoryCacheSize 32768

<Location "/svn/">
  DAV visualsvn

  SVNListParentPath on
  SVNParentPath "E:/学期项目二/Repositorries/"
  SVNIndexXSLT "/!/assets/xsl/svnindex-ng.xsl?v=2"

  SVNPathAuthz short_circuit

  SVNCacheTextDeltas off
  SVNCacheFullTexts off
  SVNCacheRevProps off
  SVNCacheNodeProps on
  SVNBlockRead off

  SVNAllowBulkUpdates prefer

  AuthName "VisualSVN Server"
  AuthzVisualSVNMode Subversion
  AuthzVisualSVNSubversionReposRelativeAccessFile "VisualSVN-SvnAuthz.ini"
  AuthzVisualSVNSubversionGroupsFile "E:/学期项目二/Repositorries/groups.conf"

  ExpiresActive off
  Header always setifempty Content-Security-Policy "default-src 'none'"
</Location>

Alias /! WebUI
<Location /!>
  AuthzVisualSVNAuthoritative off
  SVNOverrideAll on
  DAV off
  ExpiresActive on
  Header always set Content-Security-Policy "default-src 'none';form-action 'none';connect-src 'self'"
  Header always set X-Frame-Options DENY

  <IfModule mime_module>
    AddCharset utf-8 .css
  </IfModule>
</Location>

<Location /!/index.html>
  Header always set Content-Security-Policy "default-src 'none';img-src 'self' http: https: blob: data:;script-src 'self' 'unsafe-eval';style-src 'self' 'unsafe-inline';connect-src 'self' blob:;font-src 'self' blob: data:;form-action 'self';child-src 'self';frame-src 'none';worker-src 'self'"
</Location>

<Location /!/assets>
  ExpiresDefault A31104000
</Location>

<Location /!/assets/img/favicon.ico>
  ExpiresDefault A604800
</Location>

<IfModule dir_module>
  DirectoryIndex index.html
</IfModule>

ErrorLog nul
LogLevel warn
TraceEnable off

<IfModule mime_module>
  TypesConfig conf/mime.types
  AddType application/x-compress .Z
  AddType application/x-gzip .gz .tgz
  AddType application/x-x509-ca-cert .crt
  AddType application/x-pkcs7-crl    .crl
</IfModule>

<IfModule ssl_module>
SSLEngine on
SSLRandomSeed startup   builtin
SSLRandomSeed connect   builtin
SSLPassPhraseDialog     builtin
SSLSessionCache         none
SSLSessionCacheTimeout  7200
SSLCertificateFile      certs/server.pem
SSLCertificateKeyFile   certs/server.pem
SSLCertificateChainFile certs/certchain.pem
SSLHonorCipherOrder     on
SSLProtocol             -ALL +TLSv1 +TLSv1.1 +TLSv1.2 +TLSv1.3
SSLCipherSuite        TLSv1.3 TLS_AES_128_GCM_SHA256:TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256
SSLCipherSuite        SSL ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES128-SHA256:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES128-SHA256:ECDHE-RSA-AES256-SHA384:AES128-GCM-SHA256:AES128-SHA256:AES256-GCM-SHA384:AES256-SHA256:ECDHE-ECDSA-AES128-SHA:ECDHE-ECDSA-AES256-SHA:ECDHE-RSA-AES128-SHA:ECDHE-RSA-AES256-SHA:AES128-SHA:AES256-SHA:!aNULL:!eNULL:!LOW:!EXP:!RC4
</IfModule>


Include conf/httpd-custom.conf

